{% load static %}

<!DOCTYPE html>
<html>

<head>
    {% include '_head.html' %}
    <link rel="stylesheet" type="text/css" href="{% static 'css/base.css' %}">
    <link rel="icon" href="{% static 'images/bimby-logo.png' %}" type="image/png" sizes="16x16">
</head>

<body>
    <div class="container-fluid px-0">
        <!-- Top Navbar -->
        <nav class="navbar navbar-expand-lg mx-0 mt-0 px-4 pt-3">
            <a class="navbar-brand ml-2 mr-4" href="{% url 'eventos:home' %}"><img src="{% static 'images/bimby-logo.png' %}" alt="" style="width: 65%"></a>
            <a class="mr-4 ml-auto d-lg-none" href="{% url 'users:profile' %}">
                <img class="rounded-circle mr-2" style="width: 35px; height: 35px;"
                        src="{{ user.profile.image.url }}">{{ user.username }}
            </a>
            <button class="btn navbar-toggler mr-2" type="button" data-toggle="collapse" data-target="#navbarSupportedContent" aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
                <i class="fas fa-bars"></i>
            </button>
          
            <div class="collapse navbar-collapse nav justify-content-lg-center flex-column flex-lg-row p-3 p-lg-0" id="navbarSupportedContent">
                <!-- <li class="nav-item menu-item mx-lg-1 mx-xl-4">
                    <a class="nav-link active" href="{% url 'eventos:evento' %}">Informação Geral</a>
                </li> -->
                <li class="nav-item menu-item mx-lg-1 mx-xl-4">
                    <a class="nav-link" href="{% url 'locais:lojas' %}">Lojas Bimby®</a>
                </li>
                <li class="nav-item menu-item mx-lg-1 mx-xl-4">
                    <a class="nav-link" href="{% url 'eventos:receitas' %}">Receitas</a>
                </li>
                <li class="nav-item menu-item mx-lg-1 mx-xl-4">
                    <a class="nav-link" href="{% url 'eventos:promos' %}">Descontos</a>
                </li>
                <li class="nav-item menu-item mx-lg-1 mx-xl-4">
                    <a class="nav-link" href="{% url 'eventos:generate_bb_code' %}">Passatempo</a>
                </li>
                {% if user.is_authenticated %}
                <li class="menu-user d-block d-lg-none">
                    <hr class="d-lg-none" style="border-top: 1px solid white;">
                    <button onclick="logOut()" class="btn-rev btn-md mr-1"
                        style="padding: 0.5rem 1rem;"><i class="fas fa-power-off"></i>&nbsp; Logout
                    </button>
                </li>
                {% endif %}
            </div>

            {% if user.is_authenticated %}
            <a class="d-none d-lg-inline-block mr-1 px-3 py-2 menu-user" href="{% url 'users:profile' %}">
                <img class="rounded-circle mr-2" src="{{ user.profile.image.url }}">{{ user.username }}
            </a>
            <button onclick="logOut()" class="btn btn-md mr-2 d-none d-lg-inline-block" style="padding-left: 12px; padding-right: 12px;"><i class="fas fa-power-off"></i></button>
            {% endif %}
        </nav>

        
        <!-- Page Content  -->
        <div id="content">
            <div>
                {% for message in messages %}
                <div class="text-center alert alert-{{ message.tags }}">
                    <i style="font-size: 20px;" class="fas fa-exclamation-circle"></i>
                    {{ message }}
                </div>
                {% endfor %}
                {% block content %}{% endblock %}
            </div>
        </div>
        <div class="d-none d-sm-none d-md-block w-100" style="color: rgb(221, 221, 221); text-align: center; position: relative; bottom: 0; text-align: center; font-size: 12px;">
            <div class="row p-5 m-0" style="background-color: #01a28d;">
                <div class="col-4">
                    <span>
                        Termos e Condições
                    </span>
                </div>
                <div class="col-4">
                    <span>
                        Politica de privacidade
                    </span>
                </div>
                <div class="col-4">
                    <span>
                        links para SoMe 
                    </span>
                </div>
            </div>
            <div class="row p-1 m-0" style="background-color: grey;">
                <div class="col mx-auto">
                    <span style="color: white;">v. 23.03.01 - </span>
                    <a href="https://qloudyx.pt" target="_blank"> &#169; {% now "Y" %}, eXcellerated by qloudyx.</a>
                </div>
            </div>
        </div>
        
        
    </div>
    {% include '_footer.html' %}
    <script id="jsLogoutTemplate" type="text/x-kendo-template">
        <div>
            <p>{{ user.username }}, a presente sessão será encerrada, confirma?</p>
        </div>
    </script>
    <script>
        var LogOutScripts = (function () {
            // Instance stores a reference to the LogOutScripts
            var instance;
            // Dialog object
            var dialog = $("<div />");

            function init() {
                dialog = dialog.kendoDialog({
                    title: "Terminar sessão",
                    content: kendo.template($("#jsLogoutTemplate").html()),
                    closable: false,
                    buttonLayout: "normal",
                    actions: [
                        {
                            text: "Sim",
                            action: function (e) {
                                window.location.href = "{% url 'users:logout' %}";
                                return true;
                            }
                        },
                        {
                            text: "Não",
                            primary: true,
                            action: function (e) {
                                // Do something...
                                // We must return true otherwise the modal will not close
                                return true;
                            }
                        }]
                }).data("kendoDialog");

                return {

                    open: function () {
                        return dialog.open();
                    },

                    close: function () {
                        return dialog.close();
                    },

                    getDialog: function () {
                        return dialog;
                    },

                    isHidden: function () {
                        return $(dialog.wrapper).is(":hidden");
                    }
                };
            }

            return {

                start: function () {

                    if (!instance) {
                        instance = init();
                    }

                    return instance;
                }

            };
        })();

        function logOut() {
            // Initialize or Start LogoutScripts
            var logoutDialog = LogOutScripts.start();
            if (logoutDialog != null) {
                if (logoutDialog.isHidden()) {
                    logoutDialog.open();
                }
            }
            
        }
    </script>
</body>

</html>